---
title: "Pathology Articles From Turkey Compared to All Published Articles"
output: html_notebook
---

# europepmc

https://cran.r-project.org/web/packages/europepmc/index.html

https://cran.r-project.org/web/packages/europepmc/vignettes/evergreenreviewgraphs.html


```{r}
library(europepmc)
```


```{r}
articlesPerTotalArticles <- europepmc::epmc_hits_trend(query = "(AFF:'Turkey') AND ((AFF:'pathology') OR (AFF:'Pathology'))", period = 1980:2017)

articlesPerTotalArticles
```



A trend graph of articles of #pathologist from #Turkey derived from Europe PMC #RStats #europepmc #evergreenreviewgraph #pathology  #research #bibliography


```{r}
library(ggplot2)
ggplot(articlesPerTotalArticles, aes(year, query_hits / all_hits)) + 
  geom_point() + 
  geom_line() +
  xlab("Year published") + 
  ylab("Proportion of Pathology articles \n from Turkey in Europe PMC")
```


---

# PubMed 

## Data retriveal from PubMed using EDirect 

Article PMID downloaded as `txt`.

```{r Search PubMed download PMID, eval=FALSE, include=FALSE}
myTerm <- rstudioapi::terminalCreate(show = FALSE)
rstudioapi::terminalSend(
    myTerm,
    "esearch -db pubmed -query \"(pathology[Affiliation] OR patoloji[Affiliation]) AND (Turkey[Affiliation] OR TÃ¼rkiye[Affiliation])\" -datetype PDAT -mindate 1800 -maxdate 3000 | \ efetch -format uid > data/pubmed_result_TurkPath_uid.txt \n"
)
Sys.sleep(1)
repeat {
    Sys.sleep(0.1)
    if (rstudioapi::terminalBusy(myTerm) == FALSE) {
        print("Code Executed")
        break
    }
}
```


---


```{r Search local PubMed with downloaded PMID extract data as xml, eval=FALSE, include=FALSE}
myTerm <- rstudioapi::terminalCreate(show = FALSE)
rstudioapi::terminalSend(
    myTerm,
    "cat data/pubmed_result_TurkPath_uid.txt | \ fetch-pubmed -path /Volumes/Agu2018/PubMed > data/pubmed_result_TurkPath.xml \n"
)
Sys.sleep(1)
repeat {
    Sys.sleep(0.1)
    if (rstudioapi::terminalBusy(myTerm) == FALSE) {
        print("Code Executed")
        break
    }
}
```




---



```{r extract doi from xml, message=FALSE, warning=FALSE}
myTerm <- rstudioapi::terminalCreate(show = FALSE)
rstudioapi::terminalSend(
myTerm,
"xtract -input data/pubmed_result_TurkPath.xml -pattern PubmedArticle -block ArticleId -if ArticleId@IdType -equals doi -element ArticleId > data/pubmed_result_TurkPath_doi.txt \n"
)
Sys.sleep(1)
repeat {
Sys.sleep(0.1)
if (rstudioapi::terminalBusy(myTerm) == FALSE) {
print("Code Executed")
break
}
}
```


```{r}
library(tidyverse)
pubmed_result_TurkPath_doi <- read.delim("data/pubmed_result_TurkPath_doi.txt", header = FALSE)
```


```{r}
pubmed_result_TurkPath_doi$V1[grep("^10.", pubmed_result_TurkPath_doi$V1)]

pubmed_result_TurkPath_doi$V2 <- grepl(
  pattern = "^10.",
  x = pubmed_result_TurkPath_doi$V1
)

pubmed_result_TurkPath_doi2 <- pubmed_result_TurkPath_doi %>% 
  filter(pubmed_result_TurkPath_doi$V2 == TRUE) %>% 
  select(V1)

write_csv(pubmed_result_TurkPath_doi2, "data/pubmed_result_TurkPath_doi2.txt", col_names = FALSE)


```


---

# WOS data for VOSviewer


```
(AD=Turkey AND SU=Pathology) OR (CU=Turkey AND SU=Pathology)
Indexes=SCI-EXPANDED, SSCI, A&HCI, CPCI-S, CPCI-SSH, BKCI-S, BKCI-SSH, ESCI Timespan=All years
```





