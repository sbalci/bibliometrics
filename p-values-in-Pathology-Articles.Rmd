---
title: "p-values in Pathology Articles"
subtitle: "A Text Analysis of PubMed Articles Using Regular Expression"
author: "Serdar Balcı, MD, Pathologist"
date: '2019-01-07'
bibliography: crossref.bib
output: 
  html_notebook: 
    code_folding: hide
    fig_caption: yes
    highlight: tango
    theme: paper
    toc_depth: 5
  html_document: 
    code_folding: hide
    df_print: kable
    fig_caption: yes
    highlight: pygments
    keep_md: yes
    theme: paper
    toc_depth: 5
---

# p-values in Pathology Articles {.tabset .tabset-fade .tabset-pills}


```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width = 12, fig.height = 8, fig.path = 'figure/', echo = FALSE, warning = FALSE, message = FALSE, error = FALSE, eval = TRUE, tidy = TRUE, comment = NA)
```


```{r library, include=FALSE}
library(tidyverse)
```


---

## Introduction

---

### p-values

@Nead_2018 


### significance term throughout years


```{r}
library(europepmc)

significanTerm <- europepmc::epmc_hits_trend(query = "significan*", period = 1980:2017)

significanTerm

```


```{r}
library(ggplot2)
ggplot(significanTerm, aes(year, query_hits / all_hits)) + 
  geom_point() + 
  geom_line() +
  xlab("Year published") + 
  ylab("Proportion of 'significan*' \n articles in Europe PMC")
```



### Aim




## Analysis

---

### Materials and Methods



#### Regular Expression

```
{regular expression code}
p[<>=]0\.\d{1,7}|p.[<>=].0\.\d{1,7}|significant|nonsignificant|non-significant
```


---

#### Data retriveal from PubMed using EDirect

Articles are downloaded as `xml`.



```{r Search PubMed write ModPathol2016plus data as xml, eval=FALSE, include=FALSE}
myTerm <- rstudioapi::terminalCreate(show = FALSE)
rstudioapi::terminalSend(
    myTerm,
    "esearch -db pubmed -query \"'Mod Pathol'[Journal] \" -datetype PDAT -mindate 2016 -maxdate 3000 | efetch -format xml > data/ModPathol2016plus.xml \n"
)
Sys.sleep(1)
repeat {
    Sys.sleep(0.1)
    if (rstudioapi::terminalBusy(myTerm) == FALSE) {
        print("Code Executed")
        break
    }
}
```



<!-- ```{r Search PubMed get 2018 data on the fly, eval=FALSE, include=FALSE} -->
<!-- myTerm <- rstudioapi::terminalCreate(show = FALSE) -->
<!-- rstudioapi::terminalSend( -->
<!--     myTerm, -->
<!--     "esearch -db pubmed -query \"Turkey[Affiliation]\" -datetype PDAT -mindate 2018 -maxdate 3000 | efetch -format xml | xtract  -pattern PubmedArticle -element MedlineCitation/PMID PubDate/Year Journal/ISSN ISOAbbreviation> data/onthefly_Turkey_2018.csv \n" -->
<!-- ) -->
<!-- Sys.sleep(1) -->
<!-- repeat { -->
<!--     Sys.sleep(0.1) -->
<!--     if (rstudioapi::terminalBusy(myTerm) == FALSE) { -->
<!--         print("Code Executed") -->
<!--         break -->
<!--     } -->
<!-- } -->
<!-- ``` -->



<!-- ```{r Search PubMed get all data on the fly, eval=FALSE, include=FALSE} -->
<!-- myTerm <- rstudioapi::terminalCreate(show = FALSE) -->
<!-- rstudioapi::terminalSend( -->
<!--     myTerm, -->
<!--     "esearch -db pubmed -query \"Turkey[Affiliation]\" -datetype PDAT -mindate 1800 -maxdate 3000 | efetch -format xml | xtract  -pattern PubmedArticle -element MedlineCitation/PMID PubDate/Year Journal/ISSN ISOAbbreviation> data/onthefly_Turkey_all.csv \n" -->
<!-- ) -->
<!-- Sys.sleep(1) -->
<!-- repeat { -->
<!--     Sys.sleep(0.1) -->
<!--     if (rstudioapi::terminalBusy(myTerm) == FALSE) { -->
<!--         print("Code Executed") -->
<!--         break -->
<!--     } -->
<!-- } -->
<!-- ``` -->



<!-- Journal Names are extracted from xml. -->



<!-- ```{r extract journal names from 2018 xml, eval=FALSE, message=FALSE, warning=FALSE, include=FALSE} -->
<!-- myTerm <- rstudioapi::terminalCreate(show = FALSE) -->
<!-- rstudioapi::terminalSend( -->
<!-- myTerm, -->
<!-- "xtract -input data/Turkey_2018.xml -pattern PubmedArticle -element MedlineCitation/PMID PubDate/Year Journal/ISSN ISOAbbreviation > data/Turkey2018.csv \n" -->
<!-- ) -->
<!-- Sys.sleep(1) -->
<!-- repeat { -->
<!-- Sys.sleep(0.1) -->
<!-- if (rstudioapi::terminalBusy(myTerm) == FALSE) { -->
<!-- print("Code Executed") -->
<!-- break -->
<!-- } -->
<!-- } -->
<!-- ``` -->






----


<!-- #### Retrieval of Data of Properties of Journals -->



[nlmcatalog_result_journals_pmc.xml](https://www.ncbi.nlm.nih.gov/portal/utils/file_backend.cgi?Db=nlmcatalog&HistoryId=NCID_1_69755278_130.14.18.97_5555_1534585934_3590606783_0MetA0_S_HStore&QueryKey=2&Sort=PubDate&Filter=all&CompleteResultCount=2559&Mode=file&View=xml&p$l=Email&portalSnapshot=%2Fprojects%2Fentrez%2Fpubmed%2FPubMedGroup@1.136&BaseUrl=&PortName=live&RootTag=NLMCatalogRecordSet&DocType=NLMCatalogRecordSet%20PUBLIC%20%22-%2F%2FNLM%2F%2FDTD%20NLMCatalogRecordSet,%201st%20June%202017%2F%2FEN%22%20%22https://www.nlm.nih.gov/databases/dtd/nlmcatalogrecordset_170601.dtd%22&FileName=&ContentType=xml)


[nlmcatalog_result_currentlyindexed.xml](https://www.ncbi.nlm.nih.gov/portal/utils/file_backend.cgi?Db=nlmcatalog&HistoryId=NCID_1_69755278_130.14.18.97_5555_1534585934_3590606783_0MetA0_S_HStore&QueryKey=1&Sort=PubDate&Filter=all&CompleteResultCount=5242&Mode=file&View=xml&p$l=Email&portalSnapshot=%2Fprojects%2Fentrez%2Fpubmed%2FPubMedGroup@1.136&BaseUrl=&PortName=live&RootTag=NLMCatalogRecordSet&DocType=NLMCatalogRecordSet%20PUBLIC%20%22-%2F%2FNLM%2F%2FDTD%20NLMCatalogRecordSet,%201st%20June%202017%2F%2FEN%22%20%22https://www.nlm.nih.gov/databases/dtd/nlmcatalogrecordset_170601.dtd%22&FileName=&ContentType=xml)


[scimagojr2017.csv](https://www.scimagojr.com/journalrank.php?out=xls)

[scimagojr2017-wos.csv](https://www.scimagojr.com/journalrank.php?wos=true&out=xls)


![](images/scidata.png)



-element MedlineTA  NLMCatalogRecord/NlmUniqueID -def 'na' -sep '\t' -block TitleAlternate/Title   -element TitleAlternate/Title

"xtract -input data/nlmcatalog_result_currentlyindexed.xml -pattern NCBICatalogRecord -element ISSNLinking -def 'na' -sep ' ' -block TitleAlternate/Title -if TitleAlternate/Title@Sort -equals N -element TitleAlternate/Title  > data/nlmcatalog.csv \n"

-sep '\t'


NLMCatalogRecord/NlmUniqueID ISSNLinking



---

## Results

---



---

## Discussion

---


### Comment

---



---


## Feedback

---

[Serdar Balcı, MD, Pathologist](https://github.com/sbalci) would like to hear your feedback: https://goo.gl/forms/YjGZ5DHgtPlR1RnB3

This document will be continiously updated and the last update was on `r Sys.Date()`.



---

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://https-sbalci-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



---

## Back to Main Page for Bibliographic Analysis

---

[Main Page for Bibliographic Analysis](https://sbalci.github.io/pubmed/BibliographicStudies.html)


---

## References  

---

https://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html#inline_references

The Use of “Trend” Statements to Describe Statistically Nonsignificant Results in the Oncology Literature  
JAMA Oncol. 2018;4(12):1778-1779. doi:10.1001/jamaoncol.2018.4524  
https://jamanetwork.com/journals/jamaoncology/fullarticle/2705969  


---



```{r knitcitations}
# knitcitations::citep("10.1186/s12905-016-0336-0")
```





---

=================



## Aim 

**Aim:**

Here we will look at the Journals in which articles from Turkey are published. 

---

## Data retriveal from PubMed using EDirect 

Articles are downloaded as `xml`.



<!-- ```{r Search PubMed write 2018 data as xml, eval=FALSE, include=FALSE} -->
<!-- myTerm <- rstudioapi::terminalCreate(show = FALSE) -->
<!-- rstudioapi::terminalSend( -->
<!--     myTerm, -->
<!--     "esearch -db pubmed -query \"Turkey[Affiliation]\" -datetype PDAT -mindate 2018 -maxdate 3000 | efetch -format xml > data/Turkey_2018.xml \n" -->
<!-- ) -->
<!-- Sys.sleep(1) -->
<!-- repeat { -->
<!--     Sys.sleep(0.1) -->
<!--     if (rstudioapi::terminalBusy(myTerm) == FALSE) { -->
<!--         print("Code Executed") -->
<!--         break -->
<!--     } -->
<!-- } -->
<!-- ``` -->




```{r Search PubMed write all data as xml, eval=FALSE, include=FALSE}
myTerm <- rstudioapi::terminalCreate(show = FALSE)
rstudioapi::terminalSend(
    myTerm,
    "esearch -db pubmed -query \"Turkey[Affiliation]\" -datetype PDAT -mindate 1800 -maxdate 3000 | efetch -format xml > data/Turkey_all.xml \n"
)
Sys.sleep(1)
repeat {
    Sys.sleep(0.1)
    if (rstudioapi::terminalBusy(myTerm) == FALSE) {
        print("Code Executed")
        break
    }
}
```





<!-- ```{r Search PubMed get 2018 data on the fly, eval=FALSE, include=FALSE} -->
<!-- myTerm <- rstudioapi::terminalCreate(show = FALSE) -->
<!-- rstudioapi::terminalSend( -->
<!--     myTerm, -->
<!--     "esearch -db pubmed -query \"Turkey[Affiliation]\" -datetype PDAT -mindate 2018 -maxdate 3000 | efetch -format xml | xtract  -pattern PubmedArticle -element MedlineCitation/PMID PubDate/Year Journal/ISSN ISOAbbreviation> data/onthefly_Turkey_2018.csv \n" -->
<!-- ) -->
<!-- Sys.sleep(1) -->
<!-- repeat { -->
<!--     Sys.sleep(0.1) -->
<!--     if (rstudioapi::terminalBusy(myTerm) == FALSE) { -->
<!--         print("Code Executed") -->
<!--         break -->
<!--     } -->
<!-- } -->
<!-- ``` -->



<!-- ```{r Search PubMed get all data on the fly, eval=FALSE, include=FALSE} -->
<!-- myTerm <- rstudioapi::terminalCreate(show = FALSE) -->
<!-- rstudioapi::terminalSend( -->
<!--     myTerm, -->
<!--     "esearch -db pubmed -query \"Turkey[Affiliation]\" -datetype PDAT -mindate 1800 -maxdate 3000 | efetch -format xml | xtract  -pattern PubmedArticle -element MedlineCitation/PMID PubDate/Year Journal/ISSN ISOAbbreviation> data/onthefly_Turkey_all.csv \n" -->
<!-- ) -->
<!-- Sys.sleep(1) -->
<!-- repeat { -->
<!--     Sys.sleep(0.1) -->
<!--     if (rstudioapi::terminalBusy(myTerm) == FALSE) { -->
<!--         print("Code Executed") -->
<!--         break -->
<!--     } -->
<!-- } -->
<!-- ``` -->



Journal Names are extracted from xml.



<!-- ```{r extract journal names from 2018 xml, eval=FALSE, message=FALSE, warning=FALSE, include=FALSE} -->
<!-- myTerm <- rstudioapi::terminalCreate(show = FALSE) -->
<!-- rstudioapi::terminalSend( -->
<!-- myTerm, -->
<!-- "xtract -input data/Turkey_2018.xml -pattern PubmedArticle -element MedlineCitation/PMID PubDate/Year Journal/ISSN ISOAbbreviation > data/Turkey2018.csv \n" -->
<!-- ) -->
<!-- Sys.sleep(1) -->
<!-- repeat { -->
<!-- Sys.sleep(0.1) -->
<!-- if (rstudioapi::terminalBusy(myTerm) == FALSE) { -->
<!-- print("Code Executed") -->
<!-- break -->
<!-- } -->
<!-- } -->
<!-- ``` -->


```{r extract journal names from all data xml, message=FALSE, warning=FALSE}
myTerm <- rstudioapi::terminalCreate(show = FALSE)
rstudioapi::terminalSend(
myTerm,
"xtract -input data/Turkey_all.xml -pattern PubmedArticle -sep ' ' -def 'na' -element MedlineCitation/PMID Journal/ISSN ISOAbbreviation PubDate/Year > data/TurkeyAll.csv \n"
)
Sys.sleep(1)
repeat {
Sys.sleep(0.1)
if (rstudioapi::terminalBusy(myTerm) == FALSE) {
print("Code Executed")
break
}
}
```



----


## Retrieval of Data of Properties of Journals



[nlmcatalog_result_journals_pmc.xml](https://www.ncbi.nlm.nih.gov/portal/utils/file_backend.cgi?Db=nlmcatalog&HistoryId=NCID_1_69755278_130.14.18.97_5555_1534585934_3590606783_0MetA0_S_HStore&QueryKey=2&Sort=PubDate&Filter=all&CompleteResultCount=2559&Mode=file&View=xml&p$l=Email&portalSnapshot=%2Fprojects%2Fentrez%2Fpubmed%2FPubMedGroup@1.136&BaseUrl=&PortName=live&RootTag=NLMCatalogRecordSet&DocType=NLMCatalogRecordSet%20PUBLIC%20%22-%2F%2FNLM%2F%2FDTD%20NLMCatalogRecordSet,%201st%20June%202017%2F%2FEN%22%20%22https://www.nlm.nih.gov/databases/dtd/nlmcatalogrecordset_170601.dtd%22&FileName=&ContentType=xml)


[nlmcatalog_result_currentlyindexed.xml](https://www.ncbi.nlm.nih.gov/portal/utils/file_backend.cgi?Db=nlmcatalog&HistoryId=NCID_1_69755278_130.14.18.97_5555_1534585934_3590606783_0MetA0_S_HStore&QueryKey=1&Sort=PubDate&Filter=all&CompleteResultCount=5242&Mode=file&View=xml&p$l=Email&portalSnapshot=%2Fprojects%2Fentrez%2Fpubmed%2FPubMedGroup@1.136&BaseUrl=&PortName=live&RootTag=NLMCatalogRecordSet&DocType=NLMCatalogRecordSet%20PUBLIC%20%22-%2F%2FNLM%2F%2FDTD%20NLMCatalogRecordSet,%201st%20June%202017%2F%2FEN%22%20%22https://www.nlm.nih.gov/databases/dtd/nlmcatalogrecordset_170601.dtd%22&FileName=&ContentType=xml)


[scimagojr2017.csv](https://www.scimagojr.com/journalrank.php?out=xls)

[scimagojr2017-wos.csv](https://www.scimagojr.com/journalrank.php?wos=true&out=xls)


![](images/scidata.png)





---






## Analysis

```{r Organize Journal Data 1, message=FALSE, warning=FALSE}
library(tidyverse)
library(readr)

TurkeyAll <- read_delim("data/TurkeyAll.csv", 
    "\t", escape_double = FALSE, col_names = FALSE,
    na = "na", trim_ws = TRUE)

names(TurkeyAll) <- c("PMID", "ISSN", "JournalName", "Year")

# dim(TurkeyAll)[1]

# min(TurkeyAll[,4], na.rm = TRUE)

# max(TurkeyAll[,4], na.rm = TRUE)

# glimpse(TurkeyAll)

```



```{r Organize Journal Data 2}
uniqueJournals <- TurkeyAll %>% 
    select(JournalName, ISSN) %>% 
    unique()

# dim(uniqueJournals)[1]

```


```{r Organize Journal Data 3}

TurkeyAll2 <- TurkeyAll %>% 
    mutate(Journal = paste(JournalName, ISSN, sep = " ISSN "))

ArticlesByYear <- TurkeyAll2 %>% 
    group_by(Journal, Year) %>% 
    summarise(n = n())

ArticlesByYear <- ArticlesByYear %>% 
    spread(key = Year, value = n)

TurkeyAll2 <- TurkeyAll2 %>% 
    select(Journal, JournalName, ISSN) %>% 
    unique()
    
ArticlesByYear <- left_join(ArticlesByYear, TurkeyAll2, by = "Journal") 

ArticlesByYear <- ArticlesByYear %>%
    select(
    Journal, JournalName, ISSN, everything()
    )

```


```{r scimagojr2017}

```



-element MedlineTA  NLMCatalogRecord/NlmUniqueID -def 'na' -sep '\t' -block TitleAlternate/Title   -element TitleAlternate/Title   

"xtract -input data/nlmcatalog_result_currentlyindexed.xml -pattern NCBICatalogRecord -element ISSNLinking -def 'na' -sep ' ' -block TitleAlternate/Title -if TitleAlternate/Title@Sort -equals N -element TitleAlternate/Title  > data/nlmcatalog.csv \n"

-sep '\t' 


NLMCatalogRecord/NlmUniqueID ISSNLinking

```{r nlmcatalog, message=FALSE, warning=FALSE}
myTerm <- rstudioapi::terminalCreate(show = FALSE)
rstudioapi::terminalSend(
myTerm,
"xtract -input data/nlmcatalog_result_currentlyindexed.xml -pattern NCBICatalogRecord -tab '|' -element NLMCatalogRecord/NlmUniqueID -block ISSNLinking -tab '|' -element ISSNLinking -block Title -if Title@Sort -equals N -def 'na' -tab '|' -element TitleAlternate/Title > data/nlmcatalog.csv \n"
)
Sys.sleep(1)
repeat {
Sys.sleep(0.1)
if (rstudioapi::terminalBusy(myTerm) == FALSE) {
print("Code Executed")
break
}
}

``` 


```{r}
library(readr)
nlmcatalog <- read_delim("data/nlmcatalog.csv", 
                         delim = "|",
                         escape_double = FALSE,
                         col_names = FALSE, 
                         trim_ws = TRUE)

```

```{r}

library(xml2)
data <- read_xml("data/nlmcatalog_result_currentlyindexed.xml")

# Point locations
point <- data %>% xml_find_all("//pointer")
point %>% xml_attr("latitude") %>% as.numeric()
point %>% xml_attr("longitude") %>% as.numeric()

# Start time
data %>% 
  xml_find_all("//start-valid-time") %>% 
  xml_text()

# Temperature
data %>% 
  xml_find_all("//temperature[@type='hourly']/value") %>% 
  xml_text() %>% 
  as.integer()



```






